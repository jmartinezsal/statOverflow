extends layout.pug

block content
    div.wrapper
        div.questionUser
            div
                div.username= question.User.username
                br
                img(src=question.User.avatarImage)
            div(class="questionButtons")
                a(class="button" role="button" id=`editQ`) Edit
                br
                a(class="button" role="button" id=`deleteQ`) Delete
        div(class="question")
            h1= title
            div(class="text" id="questionText") #{question.content}
            br
        form(class="hidden" id=`edit-form` action=`/question/${question.id}/edit` method="put")
            label(for="question" class="labelText") Question:
            textarea(class="text" name="question" id="inputText")
            br
            div(id="buttons")
                a(class="button" id=`submit`) Accept
                a(class="button" id=`cancel`) Cancel
        if locals.authenticated
            a(href=`#new` id=`${question.id}` class="button answerBtn") Add Answer
            div#newAnswer
        each answer in answers
            div(class=`question-answer-${question.id}` id=`${answer.id}` )
                div.questionUser
                    div.username= answer.User.username
                    img(src=answer.User.avatarImage)
                div.question(id=`${question.id}`)
                    form(class="hidden" id=`edit-form-${answer.id}` action=`/question/${question.id}/answer/edit/${answer.id}` method="put")
                        textarea(class="text" name="answer" id=`answer-${answer.id}`)
                        br
                        a(class="button" id=`submit-${answer.id}`) Accept
                        a(class="button" id=`cancel-${answer.id}`) Cancel
                    div(class=`text answer-${answer.id}` id=`answer-text-${answer.id}`)= answer.answer
                    if(userId === answer.User.id)
                        a(id=`${question.id}-${answer.id}` class="button editBtn") Edit
                        a(class="button deleteBtn") Delete
        if locals.authenticated
            div(class="questionUser hidden" id="userImg")
                div.username= locals.currUser.username
                img(src= locals.currUser.avatarImage)
            div(class="answerForm" id="new")
                form(method="post" class="hidden" id="answerForm" action=`/question/${question.id}/answer/add`)
                    textarea(id="answer")
                    br
                    div(class="center")
                        a(class="button addBtn" id=`${question.id}`) Accept
                        a(class="button" id="cancelBtn") Cancel
                div(class="answerContainer" id=`${question.id}`)
                script(src="/javascripts/answers.js")
